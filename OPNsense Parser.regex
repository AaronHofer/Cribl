^<(?<PRI>\d{1,3})>(?<VERSION>\d)\s(?<TIMESTAMP>\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?(?:Z|[+-]\d{2}:\d{2}))\s(?<HOSTNAME>[^\s\[=]+)\s(?<appname>[^\s\[=]+)\s(?<procid>[^\s\[=]+)\s(?<MSGID>[^\s\[=]+)\s(?<STRUCTUREDDATA>\[.*?\]|-)\s(?<MESSAGE>(?<rule_number>[^,]*),(?<sub_rule>[^,]*),(?<anchor>[^,]*),(?<rule_uid>[^,]*),(?<interface>[^,]*),(?<reason>[^,]*),(?<action>[^,]*),(?<direction>[^,]*),(?<ip_version>[^,]*),(?<tos>[^,]*),(?<ecn>[^,]*),(?<ttl>[^,]*),(?<ip_id>[^,]*),(?<ip_offset>[^,]*),(?<ip_flags>[^,]*),(?<protocol_id>[^,]*),(?<protocol>tcp|udp|icmp),(?<packet_length>[^,]*),(?<src_ip>[^,]*),(?<dest_ip>[^,]*)(?:(?:,(?<src_port>[^,]*),(?<dest_port>[^,]*),(?<data_length>[^,]*)(?:(?:,(?<tcp_flags>[^,]*),(?<tcp_seq>[^,]*),(?<tcp_ack>[^,]*),(?<tcp_window>[^,]*),(?<tcp_urg>[^,]*),(?<tcp_options>.*))?)?$)|(?:,datalength=(?<datalength>.*))?))$